<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç»™å¨œçš„æƒŠå–œå¼¹çª—</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Arial Rounded MT Bold', 'Arial', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5e6ff 0%, #e6ccff 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 20px;
            overflow-x: hidden;
            color: #4a1a7a;
        }
        
        .container {
            text-align: center;
            max-width: 800px;
            width: 100%;
            padding: 20px;
        }
        
        header {
            margin-bottom: 40px;
        }
        
        h1 {
            font-size: 3.5rem;
            color: #7b1fa2;
            text-shadow: 3px 3px 0 #e1bee7;
            margin-bottom: 15px;
            position: relative;
            display: inline-block;
        }
        
        h1:after {
            content: "";
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 200px;
            height: 5px;
            background: #ba68c8;
            border-radius: 5px;
        }
        
        .subtitle {
            font-size: 1.4rem;
            color: #8e24aa;
            margin-bottom: 30px;
        }
        
        .main-btn {
            background: linear-gradient(45deg, #9c27b0, #7b1fa2);
            color: white;
            border: none;
            padding: 20px 50px;
            font-size: 1.8rem;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 10px 20px rgba(123, 31, 162, 0.3);
            transition: all 0.3s ease;
            margin-top: 20px;
            position: relative;
            overflow: hidden;
            z-index: 1;
        }
        
        .main-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 25px rgba(123, 31, 162, 0.4);
        }
        
        .main-btn:active {
            transform: translateY(0);
        }
        
        .main-btn:before {
            content: "";
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: 0.5s;
            z-index: -1;
        }
        
        .main-btn:hover:before {
            left: 100%;
        }
        
        .click-counter {
            font-size: 1.2rem;
            color: #8e24aa;
            margin-top: 20px;
            background: rgba(255, 255, 255, 0.7);
            padding: 10px 20px;
            border-radius: 30px;
            display: inline-block;
        }
        
        .instructions {
            background: rgba(255, 255, 255, 0.8);
            padding: 15px;
            border-radius: 15px;
            margin-top: 30px;
            color: #6a1b9a;
            font-size: 1.1rem;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            border: 2px dashed #ba68c8;
        }
        
        .popup-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1000;
        }
        
        .popup {
            position: absolute;
            width: 320px;
            min-height: 220px;
            background: linear-gradient(135deg, #e1bee7, #ce93d8);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
            pointer-events: auto;
            border: 5px solid #ab47bc;
            transform: scale(0);
            transition: transform 0.3s ease-out;
            z-index: 1001;
            overflow: hidden;
        }
        
        .popup.show {
            transform: scale(1);
            animation: popupAppear 0.5s ease-out;
        }

        /* å°å¼¹çª—æ ·å¼ */
        .popup.mini {
            width: 150px;
            height: 100px;
            font-size: 14px;
            padding: 15px;
            z-index: 1002;
            background: linear-gradient(135deg, #f8bbd9, #f48fb1);
        }

        .popup.mini .popup-content {
            font-size: 16px;
            min-height: auto;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        
        @keyframes popupAppear {
            0% { transform: scale(0) rotate(-180deg); }
            70% { transform: scale(1.1) rotate(5deg); }
            100% { transform: scale(1) rotate(0deg); }
        }
        
        .popup-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            border-bottom: 2px solid #9c27b0;
            padding-bottom: 10px;
        }
        
        .popup-title {
            font-size: 1.5rem;
            color: #7b1fa2;
            font-weight: bold;
        }
        
        .close-btn {
            background: #9c27b0;
            color: white;
            border: none;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.2rem;
        }
        
        .popup-content {
            font-size: 1.3rem;
            line-height: 1.5;
            color: #4a0072;
            margin-bottom: 20px;
            min-height: 100px;
        }
        
        .popup-footer {
            text-align: center;
            font-style: italic;
            color: #7b1fa2;
            border-top: 1px solid #ba68c8;
            padding-top: 10px;
        }
        
        .heart {
            color: #e91e63;
            animation: heartbeat 1.5s infinite;
            display: inline-block;
        }
        
        @keyframes heartbeat {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }
        
        .floating-hearts {
            position: fixed;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1; /* é™ä½çˆ±å¿ƒå±‚çš„z-indexï¼Œç¡®ä¿ğŸ¦„åœ¨ä¸Šå±‚ */
        }

        .heart-icon {
            position: absolute;
            color: rgba(156, 39, 176, 0.3);
            font-size: 24px;
            animation: float 6s ease-in infinite;
        }

        .floating-unicorns {
            position: fixed;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
        }

        .unicorn-icon {
            position: absolute;
            font-size: 36px;
            animation: float 8s ease-in infinite;
            opacity: 0.6;
        }
        
        @keyframes float {
            0% { transform: translateY(100vh) rotate(0deg); opacity: 0; }
            10% { opacity: 0.7; }
            90% { opacity: 0.7; }
            100% { transform: translateY(-100px) rotate(360deg); opacity: 0; }
        }
        
        footer {
            margin-top: 40px;
            color: #7b1fa2;
            font-size: 1rem;
            text-align: center;
            padding: 15px;
            width: 100%;
            border-top: 2px solid #e1bee7;
        }
        
        /* Xenaæ¸¸åŠ¨å…ƒç´ æ ·å¼ */
        #xena {
            position: fixed;
            font-size: 24px;
            font-weight: bold;
            color: white;
            z-index: 500;
            cursor: pointer;
            transition: transform 0.2s;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
            padding: 8px 15px;
            border-radius: 20px;
            background: linear-gradient(45deg, #9c27b0, #7b1fa2);
            box-shadow: 0 4px 15px rgba(156, 39, 176, 0.4);
            display: flex;
            align-items: center;
            justify-content: center;
            animation: xenaFloat 3s ease-in-out infinite;
            border: 2px solid white;
        }

        @keyframes xenaFloat {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            25% { transform: translateY(-5px) rotate(-1deg); }
            75% { transform: translateY(5px) rotate(1deg); }
        }

        .xena-text {
            font-family: 'Arial Rounded MT Bold', 'Arial', sans-serif;
            letter-spacing: 1px;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 2.5rem;
            }

            .main-btn {
                padding: 15px 30px;
                font-size: 1.5rem;
            }

            .popup {
                width: 280px;
                min-height: 200px;
            }
        }
    </style>
</head>
<body>
    <div class="floating-hearts" id="hearts-container"></div>
    <div class="floating-unicorns" id="unicorns-container"></div>
    <!-- æ¸¸åŠ¨çš„Xenaå…ƒç´  -->
    <div id="xena" class="xena-text">Xena</div>
    
    <div class="container">
        <header>
            <h1><i class="fas fa-gift"></i> ç»™å¨œçš„æƒŠå–œ <i class="fas fa-gift"></i></h1>
        </header>
        
        <button class="main-btn" id="mainButton">
            <i class="fas fa-star"></i> ç‚¹å‡»å¼€å¯æƒŠå–œ <i class="fas fa-star"></i>
        </button>
        
        <div class="click-counter" id="clickCounter">
            å·²ç‚¹å‡»: <span id="clickCount">0</span> æ¬¡
        </div>
        
        <div class="instructions">
            <p><i class="fas fa-info-circle"></i> ç‚¹å‡»ä¸Šé¢çš„æŒ‰é’®ä¼šå‡ºç°æƒŠå–œå¼¹çª—ï¼</p>
            <p>å¼¹çª—å†…å®¹ä¼šå…ˆæ˜¾ç¤ºæˆ‘å¯¹ä½ çš„å°è±¡ï¼Œå†æ¬¡ç‚¹å‡»ä¼šæ˜¾ç¤ºæˆ‘çš„ç¥ç¦ï½</p>
            <p>å¼¹çª—å¯ä»¥æ‹–åŠ¨ï¼Œç‚¹å‡»å³ä¸Šè§’çš„Ã—å¯ä»¥å…³é—­</p>
        </div>
    </div>
    
    <div class="popup-container" id="popupContainer"></div>
    
    <footer>
        <p>ä¸“é—¨ä¸ºå¨œåˆ¶ä½œçš„æƒŠå–œé¡µé¢ <span class="heart">â¤</span> | æ„¿ä½ æ¯å¤©å¼€å¿ƒå¿«ä¹ï¼</p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const mainButton = document.getElementById('mainButton');
            const popupContainer = document.getElementById('popupContainer');
            const clickCountElement = document.getElementById('clickCount');
            const heartsContainer = document.getElementById('heartsContainer');
            const xena = document.getElementById('xena');
            
            let clickCount = 0;
            let isFirstImpression = true;
            let popupCount = 0;
            let currentPopup = null;

            // å°è±¡å†…å®¹æ•°ç»„
            const impressions = [
                "2004å¹´12æœˆ25æ—¥å‡ºç”Ÿçš„æ‘©ç¾¯åº§ï¼Œåœ£è¯å®å®ã€‚",
                "æ¥è‡ªå¹¿è¥¿æŸ³å·ï¼Œåœ¨æ¥å®¾ä¸Šå¤§å­¦ã€‚",
                "è‹±è¯­ä¸“ä¸šï¼ŒåšPPTæœ‰ä¸€æ‰‹ã€‚",
                "èº«é«˜ä¸€ç±³äº”ï¼Œç˜¦ç˜¦çš„ä½†å¾ˆæœ‰æ–™ã€‚",
                "çœ¼ç›å¸ƒçµå¸ƒçµçš„ã€‚",
                "æœ‰å¥½å¤šé£æ ¼ä¸åŒçš„è£™å­ï¼Œä»Šå¤©æ–°ä¸­å¼æ˜å¤©æ´›ä¸½å¡”ã€‚",
                "æˆ´çœ¼é•œæ—¶æ˜¾å¾—èªæ˜ï¼Œä¸æˆ´æ—¶å¾ˆèŒã€‚",
                "æ˜¯ä¸ªå¾ˆçˆ±å¹²å‡€çš„å°å¥³å­©ã€‚",
                "æ¼”è®²æ—¶æ•´ä¸ªäººåœ¨å‘å…‰ï¼Œå¾ˆå‰å®³ã€‚",
                "å”±æ­Œçš„ç¥ï¼Œèµ°è·¯è‡ªå¸¦BGMã€‚",
                "æ‹¥æœ‰æ»¡çº§æ²Ÿé€šåŠ›ï¼Œè·Ÿç€æ€»èƒ½åƒåˆ°åˆä¾¿å®œåˆå¥½çš„é¥­å’Œå¥¶èŒ¶ã€‚",
                "åƒçƒ­æƒ…æ˜åªšçš„å°å¤ªé˜³ï¼Œç…§åˆ°äººèº«ä¸Šæš–æš–çš„ã€‚",
                "æ€§æ ¼å¾ˆå‹‡æ•¢ï¼Œç¤¾äº¤èŒƒå›´å¹¿é˜”å¦‚æµ·ã€‚",
                "æ€»ä½“ä¹è§‚ï¼Œä½†è®¤çœŸåŠ²å„¿ä¸Šæ¥ä¹Ÿå¾ˆå¸…ã€‚",
                "é•¿è·‘ä¸€éª‘ç»å°˜ï¼Œä½†å†¬å¤©è·‘æ­¥å®¹æ˜“æ„Ÿå†’ã€‚",
                "ä¸–ç•Œèœ‰è£ã€ç¥ˆæˆ‘æ°¸çµ®ï¼Œæ˜åªšã€å¼ æ‰¬ã€å‹‡æ•¢ã€å¹³é™ã€‚",
                "åˆä¸€å°±æ³¨æ„åˆ°ä½ ï¼Œåœ¨æ“åœºç¬¬ä¸€æ¬¡è¯´ä¸Šè¯ï¼Œè¿˜åœ¨QQç©ºé—´ç¥ä½ ç”Ÿæ—¥å¿«ä¹ã€‚",
                "åæ¥è¿›äº†åŒä¸€ä¸ªç­çº§ï¼Œè¿˜ä¸€èµ·å‚åŠ è¿‡è·³ç»³æ¯”èµ›ï¼Œä½ æ˜¯ä¸ªå¥‡å¥³å­ã€‚",
                "å¹³æ—¶çº¿ä¸ŠèŠå¤©ä¸åœï¼Œæ”¾å‡äº†å°±è§é¢ã€‚",
                "ä½ æ˜¯æˆ‘å¿ƒä¸­çš„\"é˜³å…‰å½©è™¹å°ç™½é©¬\"ã€‚",
                "ä½ æ˜æœ—åˆæ¸©æš–ã€‚",
                "è®©æˆ‘æ›´æœ‰åº•æ°”å’Œä¸–ç•Œç¢°æ’ï¼Œåˆæ¸©æŸ”æé†’æˆ‘é¿å¼€äººæƒ…ä¸–æ•…çš„å‘ã€‚",
                "æˆ‘çŸ¥é“ä½ ä¼šä¸€ç›´å–œæ¬¢æˆ‘ï¼Œæˆ‘ä¹Ÿä¸€æ ·ã€‚",
                "æˆ‘ä»¬è¯´å¥½äº†ï¼Œæˆ‘ä¼šä¸€ç›´é™ªç€ä½ ï¼Œä½ ä¹Ÿæ˜¯ã€‚"
            ];

            // ç¥ç¦å†…å®¹æ•°ç»„
            const blessings = [
                "æ„¿å²å¹¶è°¢ï¼Œä¸é•¿å‹å…®ã€‚",
                "å²æ™šé’å±±è·¯ï¼Œç™½é¦–æœŸåŒå½’ã€‚",
                "äººç”Ÿå¾—ä¸€çŸ¥å·±è¶³çŸ£ï¼Œæ–¯ä¸–å½“ä»¥åŒæ€€è§†ä¹‹ã€‚",
                "æ•…äººå…¥æˆ‘æ¢¦ï¼Œæ˜æˆ‘é•¿ç›¸å¿†ã€‚",
                "æˆ‘è§å›æ¥ï¼Œé¡¿è§‰å¾åºï¼Œæºªå±±ç¾å“‰ã€‚",
                "æ„¿ä½ ä»ç„¶æ˜¯æ–°æ—¶ä»£çš„æ¸…é£ï¼ŒçŒæ³¨åœ¨æˆ‘çš„çµé­‚ä¹‹ä¸­ã€‚",
                "æ„¿ä½ çš„æœªæ¥çº¯å‡€æ˜æœ—ï¼Œåƒä½ æ­¤åˆ»çš„å¯çˆ±ç›®å…‰ï¼Œåœ¨ä¸–é—´ç¾å¥½çš„å‘½è¿ä¸­ï¼Œæ„¿ä½ çš„å‘½è¿ç¾å¥½æ¬¢ç•…ã€‚",
                "æ¡¥éƒ½åšå›ºï¼Œéš§é“éƒ½å…‰æ˜ã€‚",
                "æ„¿ä½ åœ¨è¿·èŒ«æ—¶ï¼Œåšä¿¡ä½ çš„çè´µã€‚çˆ±ä½ æ‰€çˆ±ï¼Œè¡Œä½ æ‰€è¡Œï¼Œå¬ä»ä½ å¿ƒï¼Œæ— é—®è¥¿ä¸œã€‚",
                "é‚£æˆ‘ç¥ä½ ä¸‡äº‹èƒœæ„å§ã€‚æ„æ€å°±æ˜¯ï¼Œä¸€åˆ‡éƒ½æ¯”ä½ è‡ªå·±æ‰€æœŸå¾…çš„ï¼Œè¿˜è¦å¥½ä¸€ç‚¹ç‚¹ã€‚",
                "å¸Œæœ›ä½ ç»§ç»­å…´è‡´ç›ç„¶åœ°ä¸ä¸–ç•Œäº¤æ‰‹ï¼Œä¸€ç›´èµ°åœ¨å¼€æ»¡é²œèŠ±çš„è·¯ä¸Šã€‚",
                "æ°¸è¿œå‘å‰çœ‹ï¼Œæ°¸è¿œç›¸ä¿¡å¦é€”åœ¨å‰ï¼Œç›¸ä¿¡ç¾å¥½çš„äº‹ç‰©ï¼Œæ€»ä¼šè¿é¢è€Œæ¥ã€‚",
                "æ„¿ä½ ç™½å¤©æœ‰è¯´æœ‰ç¬‘ï¼Œæ™šä¸Šç¡ä¸ªå¥½è§‰ã€‚",
                "æ„¿ä½ å¤©çœŸè€Œå–„è‰¯ï¼Œæ¸©æŸ”è€Œåšå®šï¼Œé¢å¯¹å›°éš¾æ—¶ï¼Œæ€»æœ‰è¶…å‡¡è„±ä¿—çš„è‡ªä¿¡ã€‚",
                "ç›¸çŸ¥æ— è¿œè¿‘ï¼Œä¸‡é‡Œå°šä¸ºé‚»ã€‚",
                "å¸Œå›ç”Ÿç¾½ç¿¼ï¼Œä¸€åŒ–åŒ—æºŸé±¼ã€‚",
                "å‹æƒ…æ˜¯ä¸€æ ªæˆé•¿ç¼“æ…¢çš„æ¤ç‰©ã€‚",
                "æ„¿ä½ å¥½èŠ±å¸¸å¼€ï¼Œå¥½è¿å¸¸æ¥ã€‚",
                "ç”Ÿæ´»å¦‚æ„ï¼Œå‘¨æœ«æ„‰å¿«ã€‚",
                "æƒŸæœ‰æœ‹å‹ï¼Œå§‹ç»ˆé™ªåœ¨å·¦å³ï¼Œç¥å¿«ä¹æ¯ä¸€å¤©ã€‚"
            ];
            
            // åˆ›å»ºæ¼‚æµ®çˆ±å¿ƒ
            function createFloatingHearts() {
                for (let i = 0; i < 20; i++) {
                    const heart = document.createElement('div');
                    heart.className = 'heart-icon';
                    heart.innerHTML = 'â¤';
                    heart.style.left = Math.random() * 100 + 'vw';
                    heart.style.animationDelay = Math.random() * 5 + 's';
                    heart.style.fontSize = (Math.random() * 20 + 15) + 'px';
                    heartsContainer.appendChild(heart);
                }
            }

            // åˆ›å»ºæ¼‚æµ®ç‹¬è§’å…½
            function createFloatingUnicorns() {
                for (let i = 0; i < 8; i++) {
                    const unicorn = document.createElement('div');
                    unicorn.className = 'unicorn-icon';
                    unicorn.innerHTML = 'ğŸ¦„';
                    unicorn.style.left = Math.random() * 100 + 'vw';
                    unicorn.style.top = Math.random() * 100 + 'vh';
                    unicorn.style.animationDelay = Math.random() * 8 + 's';
                    unicornsContainer.appendChild(unicorn);

                    // ä¸ºæ¯ä¸ªç‹¬è§’å…½æ·»åŠ éšæœºç§»åŠ¨é€»è¾‘
                    moveUnicornRandomly(unicorn);
                }
            }

            // è®©ç‹¬è§’å…½éšæœºç§»åŠ¨
            function moveUnicornRandomly(unicorn) {
                function move() {
                    const newX = Math.random() * 100;
                    const newY = Math.random() * 100;
                    unicorn.style.left = newX + 'vw';
                    unicorn.style.top = newY + 'vh';
                    unicorn.style.transform = 'rotate(' + (Math.random() * 360) + 'deg)';

                    // éšæœºæ—¶é—´åå†æ¬¡ç§»åŠ¨
                    setTimeout(move, Math.random() * 5000 + 3000);
                }
                move();
            }
            
            // åˆ›å»ºå¼¹çª—
            function createPopup() {
                // ç§»é™¤ä¹‹å‰çš„å¼¹çª—
                if (currentPopup) {
                    currentPopup.remove();
                }
                
                // æ›´æ–°ç‚¹å‡»æ¬¡æ•°
                clickCount++;
                clickCountElement.textContent = clickCount;
                
                // åˆ›å»ºæ–°å¼¹çª—
                const popup = document.createElement('div');
                popup.className = 'popup';
                popup.id = 'popup' + popupCount;
                popupCount++;
                
                // éšæœºä½ç½®
                const maxX = window.innerWidth - 350;
                const maxY = window.innerHeight - 300;
                const randomX = Math.max(50, Math.min(maxX, Math.random() * maxX));
                const randomY = Math.max(50, Math.min(maxY, Math.random() * maxY));
                
                popup.style.left = randomX + 'px';
                popup.style.top = randomY + 'px';
                
                // è®¾ç½®å¼¹çª—å†…å®¹
                let title, content, footer;
                
                if (isFirstImpression) {
                    title = "æˆ‘å¯¹ä½ çš„å°è±¡";
                    // éšæœºé€‰æ‹©ä¸€ä¸ªå°è±¡å†…å®¹
                    const randomIndex = Math.floor(Math.random() * impressions.length);
                    content = impressions[randomIndex];
                    footer = "ä½ åœ¨æˆ‘å¿ƒä¸­çš„æ ·å­ï½";
                } else {
                    title = "æˆ‘å¯¹ä½ çš„ç¥ç¦";
                    // éšæœºé€‰æ‹©ä¸€ä¸ªç¥ç¦å†…å®¹
                    const randomIndex = Math.floor(Math.random() * blessings.length);
                    content = blessings[randomIndex];
                    footer = "æœ€å¥½çš„ç¥ç¦é€ç»™ä½ ï¼";
                }
                
                // åˆ‡æ¢ä¸‹ä¸€æ¬¡çš„å†…å®¹
                isFirstImpression = !isFirstImpression;
                
                // å¼¹çª—å†…éƒ¨ç»“æ„
                popup.innerHTML = `
                    <div class="popup-header">
                        <div class="popup-title">${title}</div>
                        <button class="close-btn" data-popup-id="${popup.id}">Ã—</button>
                    </div>
                    <div class="popup-content">${content}</div>
                    <div class="popup-footer">${footer} <span class="heart">â¤</span></div>
                `;
                
                // æ·»åŠ åˆ°å®¹å™¨
                popupContainer.appendChild(popup);
                currentPopup = popup;
                
                // æ˜¾ç¤ºå¼¹çª—åŠ¨ç”»
                setTimeout(() => {
                    popup.classList.add('show');
                }, 10);
                
                // ä½¿å¼¹çª—å¯æ‹–åŠ¨
                makePopupDraggable(popup);
                
                // æ·»åŠ å…³é—­æŒ‰é’®äº‹ä»¶
                const closeBtn = popup.querySelector('.close-btn');
                closeBtn.addEventListener('click', function() {
                    const popupId = this.getAttribute('data-popup-id');
                    const popupToClose = document.getElementById(popupId);
                    if (popupToClose) {
                        popupToClose.classList.remove('show');
                        setTimeout(() => {
                            if (popupToClose.parentNode) {
                                popupToClose.parentNode.removeChild(popupToClose);
                            }
                            if (currentPopup && currentPopup.id === popupId) {
                                currentPopup = null;
                            }
                        }, 300);
                    }
                });
                
                // éšæœºå¼¹çª—é¢œè‰²
                const colors = [
                    'linear-gradient(135deg, #e1bee7, #ce93d8)',
                    'linear-gradient(135deg, #f3e5f5, #e1bee7)',
                    'linear-gradient(135deg, #f8bbd9, #f48fb1)',
                    'linear-gradient(135deg, #d1c4e9, #b39ddb)'
                ];
                const randomColor = colors[Math.floor(Math.random() * colors.length)];
                popup.style.background = randomColor;
            }
            
            // ä½¿å¼¹çª—å¯æ‹–åŠ¨
            function makePopupDraggable(popup) {
                let isDragging = false;
                let offsetX, offsetY;
                
                const header = popup.querySelector('.popup-header');
                
                header.addEventListener('mousedown', startDrag);
                document.addEventListener('mousemove', drag);
                document.addEventListener('mouseup', stopDrag);
                
                function startDrag(e) {
                    if (e.target.className === 'close-btn') return;
                    
                    isDragging = true;
                    const rect = popup.getBoundingClientRect();
                    offsetX = e.clientX - rect.left;
                    offsetY = e.clientY - rect.top;
                    popup.style.cursor = 'grabbing';
                }
                
                function drag(e) {
                    if (!isDragging) return;
                    
                    e.preventDefault();
                    
                    let newX = e.clientX - offsetX;
                    let newY = e.clientY - offsetY;
                    
                    // é™åˆ¶åœ¨çª—å£èŒƒå›´å†…
                    const maxX = window.innerWidth - popup.offsetWidth;
                    const maxY = window.innerHeight - popup.offsetHeight;
                    
                    newX = Math.max(0, Math.min(newX, maxX));
                    newY = Math.max(0, Math.min(newY, maxY));
                    
                    popup.style.left = newX + 'px';
                    popup.style.top = newY + 'px';
                }
                
                function stopDrag() {
                    isDragging = false;
                    popup.style.cursor = 'default';
                }
            }
            
            // ä¸»æŒ‰é’®ç‚¹å‡»äº‹ä»¶
            mainButton.addEventListener('click', createPopup);
            
            // åˆå§‹åŒ–æ¼‚æµ®çˆ±å¿ƒ
            createFloatingHearts();

            // åˆå§‹åŒ–æ¼‚æµ®ç‹¬è§’å…½
            createFloatingUnicorns();

            // Xenaæ¸¸åŠ¨åŠŸèƒ½
            function initXena() {
                const xena = document.getElementById('xena');

                // è®¾ç½®Xenaåˆå§‹å¤§å°ï¼ˆå‚è€ƒé¡µé¢ä¸­çš„å…ƒç´ ï¼‰
                const mainButton = document.getElementById('mainButton');
                if (mainButton) {
                    const buttonRect = mainButton.getBoundingClientRect();
                    // æ ¹æ®æŒ‰é’®å¤§å°è°ƒæ•´Xenaçš„å¤§å°
                    const size = Math.min(buttonRect.width, buttonRect.height) * 0.15;
                    xena.style.fontSize = Math.max(16, Math.min(30, size)) + 'px';
                    xena.style.padding = Math.max(5, Math.min(10, size/3)) + 'px ' + Math.max(10, Math.min(20, size/2)) + 'px';
                }

                // åˆå§‹ä½ç½®
                let posX = Math.random() * (window.innerWidth - 100);
                let posY = Math.random() * (window.innerHeight - 60);
                xena.style.left = posX + 'px';
                xena.style.top = posY + 'px';

                // æ¸¸åŠ¨æ–¹å‘
                let dirX = (Math.random() - 0.5) * 3;
                let dirY = (Math.random() - 0.5) * 3;

                // Xenaæ¸¸åŠ¨åŠ¨ç”»
                function moveXena() {
                    // è·å–å½“å‰ä½ç½®
                    const rect = xena.getBoundingClientRect();
                    posX = rect.left;
                    posY = rect.top;

                    // è®¡ç®—æ–°ä½ç½®
                    posX += dirX;
                    posY += dirY;

                    // è¾¹ç•Œæ£€æµ‹
                    if (posX <= 0 || posX >= window.innerWidth - rect.width) {
                        dirX = -dirX;
                        // è¾¹ç•Œåå¼¹æ—¶æ”¹å˜é¢œè‰²
                        const hue = Math.floor(Math.random() * 60) + 270; // ç´«è‰²èŒƒå›´
                        xena.style.background = `linear-gradient(45deg, hsl(${hue}, 70%, 50%), hsl(${hue + 20}, 70%, 40%))`;
                    }

                    if (posY <= 0 || posY >= window.innerHeight - rect.height) {
                        dirY = -dirY;
                        // è¾¹ç•Œåå¼¹æ—¶æ”¹å˜é¢œè‰²
                        const hue = Math.floor(Math.random() * 60) + 270; // ç´«è‰²èŒƒå›´
                        xena.style.background = `linear-gradient(45deg, hsl(${hue}, 70%, 50%), hsl(${hue + 20}, 70%, 40%))`;
                    }

                    // ç¡®ä¿Xenaä¸ä¼šç§»å‡ºå±å¹•
                    posX = Math.max(0, Math.min(posX, window.innerWidth - rect.width));
                    posY = Math.max(0, Math.min(posY, window.innerHeight - rect.height));

                    // åº”ç”¨æ–°ä½ç½®
                    xena.style.left = posX + 'px';
                    xena.style.top = posY + 'px';

                    // éšæœºæ”¹å˜æ–¹å‘ï¼ˆå¢åŠ éšæœºæ€§ï¼‰
                    if (Math.random() < 0.03) {
                        dirX += (Math.random() - 0.5) * 1.5;
                        dirY += (Math.random() - 0.5) * 1.5;

                        // é™åˆ¶æœ€å¤§é€Ÿåº¦
                        const maxSpeed = 4;
                        dirX = Math.max(-maxSpeed, Math.min(dirX, maxSpeed));
                        dirY = Math.max(-maxSpeed, Math.min(dirY, maxSpeed));
                    }

                    // ç»§ç»­åŠ¨ç”»
                    requestAnimationFrame(moveXena);
                }

                // ç‚¹å‡»Xenaè§¦å‘æƒŠå–œæ•ˆæœ
                xena.addEventListener('click', function() {
                    // åˆ›å»ºä¸€ä¸ªå°å‹å¼¹çª—æƒŠå–œ
                    createMiniPopup();

                    // ç‚¹å‡»æ—¶Xenaè·³åŠ¨æ•ˆæœ
                    xena.style.transform = 'scale(1.3)';
                    setTimeout(() => {
                        xena.style.transform = 'scale(1)';
                    }, 300);

                    // æ”¹å˜æ¸¸åŠ¨æ–¹å‘å’Œé€Ÿåº¦
                    dirX = (Math.random() - 0.5) * 6;
                    dirY = (Math.random() - 0.5) * 6;

                    // æ”¹å˜é¢œè‰²
                    const hue = Math.floor(Math.random() * 60) + 270; // ç´«è‰²èŒƒå›´
                    xena.style.background = `linear-gradient(45deg, hsl(${hue}, 80%, 60%), hsl(${hue + 30}, 80%, 50%))`;
                });

                // é¼ æ ‡æ‚¬åœæ•ˆæœ
                xena.addEventListener('mouseenter', function() {
                    xena.style.transform = 'scale(1.2)';
                    xena.style.boxShadow = '0 6px 20px rgba(156, 39, 176, 0.6)';
                });

                xena.addEventListener('mouseleave', function() {
                    xena.style.transform = 'scale(1)';
                    xena.style.boxShadow = '0 4px 15px rgba(156, 39, 176, 0.4)';
                });

                // å¼€å§‹æ¸¸åŠ¨
                moveXena();
            }

            // åˆ›å»ºç‚¹å‡»Xenaæ—¶çš„å°å‹å¼¹çª—æƒŠå–œ
            function createMiniPopup() {
                const miniPopup = document.createElement('div');
                miniPopup.className = 'popup mini';

                // éšæœºé€‰æ‹©ä¸€æ¡ç¥ç¦æˆ–å°è±¡
                const isImpression = Math.random() > 0.5;
                let content, title;

                if (isImpression) {
                    const randomIndex = Math.floor(Math.random() * impressions.length);
                    content = impressions[randomIndex];
                    title = "Xenaçš„å°è±¡";
                } else {
                    const randomIndex = Math.floor(Math.random() * blessings.length);
                    content = blessings[randomIndex];
                    title = "Xenaçš„ç¥ç¦";
                }

                miniPopup.innerHTML = `
                    <div class="popup-header">
                        <div class="popup-title">${title}</div>
                    </div>
                    <div class="popup-content">${content}</div>
                    <div class="popup-footer">æ¥è‡ªXenaçš„æƒŠå–œï¼ <span class="heart">â¤</span></div>
                `;

                // éšæœºä½ç½®
                const x = Math.random() * (window.innerWidth - 250);
                const y = Math.random() * (window.innerHeight - 200);
                miniPopup.style.left = x + 'px';
                miniPopup.style.top = y + 'px';
                miniPopup.style.width = '250px';
                miniPopup.style.zIndex = '1002';

                // æ·»åŠ åˆ°é¡µé¢
                document.getElementById('popupContainer').appendChild(miniPopup);

                // æ˜¾ç¤ºåŠ¨ç”»
                setTimeout(() => {
                    miniPopup.classList.add('show');
                }, 10);

                // 5ç§’åæ¶ˆå¤±
                setTimeout(() => {
                    miniPopup.classList.remove('show');
                    setTimeout(() => {
                        if (miniPopup.parentNode) {
                            miniPopup.parentNode.removeChild(miniPopup);
                        }
                    }, 300);
                }, 5000);
            }

            // åˆå§‹åŒ–Xenaæ¸¸åŠ¨
            initXena();

            // åˆå§‹å¼¹çª—
            setTimeout(() => {
                createPopup();
            }, 1000);
        });
    </script>
</body>
</html>